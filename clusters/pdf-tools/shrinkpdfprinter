#!/usr/bin/env bash
set -euo pipefail

usage() {
  echo "Usage: $(basename "$0") INPUT.pdf [OUTPUT.pdf]" >&2
  exit 1
}

need() {
  command -v "$1" >/dev/null 2>&1 || {
    echo "Missing dependency: $1" >&2
    exit 1
  }
}

[[ $# -lt 1 || $# -gt 2 ]] && usage
input="$1"
output="${2:-output.pdf}"
[[ -f "$input" ]] || { echo "Input not found: $input" >&2; exit 1; }

need gs

gs -dNOPAUSE -dBATCH -sDEVICE=pdfwrite -dCompatibilityLevel=1.4 \
  -dPDFSETTINGS=/printer -sOutputFile="$output" "$input"
